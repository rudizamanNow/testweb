import{M as m}from"./MediaQueryListener.Do0FNeN3.js";class S{container=null;$sections=null;sectionCount=0;currentSectionIndex=0;isInSection=!1;isAtEnd=!1;scrollProgress=0;animationFrame=0;constructor(t,n){this.container=t,this.$sections=n,this.sectionCount=n.length,this.handleScroll=this.handleScroll.bind(this),this.calculateCarouselContentHeight(),this.init()}calculateCarouselContentHeight(){const t=this.container?.querySelector(".vertical-carousel-header")?.getBoundingClientRect();this.container?.querySelector(".vertical-carousel-content")?.setAttribute("style",`height:calc(100% - ${t?.height}px);`)}init(){this.container.style.height=`${100*this.sectionCount}vh`,window.addEventListener("scroll",this.handleScroll,!0),this.handleScroll()}handleScroll(){const t=this.container.getBoundingClientRect(),n=this.container.offsetHeight;this.scrollProgress=-t.top/(n-window.innerHeight);const e=this.scrollProgress*this.sectionCount,c=Math.floor(e);this.currentSectionIndex=Math.min(c,this.sectionCount-1),this.isAtEnd=Math.ceil(e)>=this.sectionCount,this.isInSection=e>0&&e<this.sectionCount,this.animationFrame=requestAnimationFrame(this.dispatchVisibilityEvent.bind(this)),this.updateUI(e)}updateUI(t){this.$sections.forEach((n,e)=>{const c=n.querySelector(".left-col"),i=n.querySelector(".right-col");if(c&&i){const o=Math.abs(t-e);let s=0;e===this.sectionCount-1&&t>=this.sectionCount-.5?s=1:s=o<.5?Math.max(0,1-o):0;let l=this.isAtEnd?0:(t-e)*-100;l=e===0&&!this.isInSection?0:l,c.setAttribute("style",`
          opacity: ${s};
          transform: translateY(${l}%);
          transition: opacity 0.2s ease-in-out;
          z-index: ${this.currentSectionIndex===e||e===0||this.isInSection?1:0};
        `);const a=this.isAtEnd&&this.currentSectionIndex===e?1:1-Math.min(o,1);i.setAttribute("style",`opacity: ${a};`)}})}dispatchVisibilityEvent(){const t=new CustomEvent("scrollTriggerVisibility",{detail:{isVisible:this.isInSection,isAtEnd:this.isAtEnd}});window.dispatchEvent(t)}destroy(){this.container.style.height="auto",this.animationFrame&&cancelAnimationFrame(this.animationFrame),this.$sections.forEach(t=>{const n=t.querySelector(".left-col"),e=t.querySelector(".right-col");n?.removeAttribute("style"),e?.removeAttribute("style")}),window.removeEventListener("scroll",this.handleScroll,!0)}}document.addEventListener("DOMContentLoaded",()=>{let r=new Set;const t=i=>{const o=i.querySelectorAll("[data-section-index]"),s=o[o?.length-1],l=s.firstElementChild,a=i.closest('[data-qa="TemplateVerticalCarouselWithStaticTitle"]')?.nextElementSibling?.nextElementSibling,h=i?.querySelector(".vertical-carousel-header")?.getBoundingClientRect();let u=h?h.height:0;if(a&&s&&l){const d=s.getBoundingClientRect().height,g=(l.getBoundingClientRect().height-d-u)/2;a.style.marginTop=`${g}px`}},n=()=>{document.querySelectorAll('[data-qa="TemplateVerticalCarouselWithStaticTitle"]').forEach(i=>{const o=i.querySelector(".vertical-carousel-scroll-container");o&&(r.add(new S(o,i.querySelectorAll("[data-section-index]"))),t(i))})};window.addEventListener("resize",()=>{document.querySelectorAll('[data-qa="TemplateVerticalCarouselWithStaticTitle"]').forEach(i=>{setTimeout(()=>t(i),1500)})});const e=()=>{[...r.entries()].forEach(([i,o])=>o.destroy()),r.clear()};new m().on({when:{from:"lg"},callback:i=>{i?n():e()}})});
