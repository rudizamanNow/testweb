class o{container;track;cards;prevButton;nextButton;breakpoints;currentPage;cardsPerPage;totalPages;liveRegion;constructor(t){this.container=t.container,this.track=t.track,this.cards=t.cards,this.prevButton=t.prevButton,this.nextButton=t.nextButton,this.liveRegion=this.container.querySelector(".carousel-live-region");const e=this.cards.length||0;this.breakpoints={375:1,768:2,1024:Math.min(e,3),1440:Math.min(e,4),...t.breakpoints},this.currentPage=0,this.cardsPerPage=this.getCardsPerPage(),this.totalPages=this.calculateTotalPages(),this.init()}init(){this.setupStyles(),this.setupEventListeners(),this.updateNavigation(),this.calculateDimensions(),this.updateAriaAttributes()}calculateTotalPages(){const t=this.cards.length;return t<=this.cardsPerPage?1:Math.ceil((t-this.cardsPerPage)/this.cardsPerPage)+1}getOptimalStartIndex(){const t=this.cards.length,{cardsPerPage:e}=this;if(this.currentPage===this.totalPages-1){if(t%e===0)return this.currentPage*e;const s=t-e;return Math.max(0,s)}return this.currentPage*e}setupStyles(){const t=this.getCurrentBreakpoint(),e=this.getTrackGap(),a=`calc((100% - ${(t-1)*e}px) / ${t})`;this.cards.forEach(s=>{s.style.flex=`0 0 ${a}`})}getCurrentBreakpoint(){const t=window.innerWidth,e=Object.keys(this.breakpoints).map(Number).sort((a,s)=>s-a);for(const a of e)if(t>=a)return this.breakpoints[a];return this.breakpoints[Math.min(...e)]}getTrackGap(){return Number(window.getComputedStyle(this.track).getPropertyValue("gap").slice(0,-2))}calculateDimensions(){this.cardsPerPage=this.getCurrentBreakpoint(),this.totalPages=this.calculateTotalPages(),this.setupStyles()}getCardsPerPage(){return this.getCurrentBreakpoint()}isLastPage(){return this.currentPage===this.totalPages-1}setupEventListeners(){this.prevButton.addEventListener("click",()=>this.navigate(-1)),this.nextButton.addEventListener("click",()=>this.navigate(1)),this.track.addEventListener("scroll",this.handleScroll.bind(this)),window.addEventListener("resize",()=>{this.calculateDimensions(),this.currentPage=Math.min(this.currentPage,this.totalPages-1),this.updateNavigation(),this.updateTrackPosition()}),this.container.addEventListener("keydown",t=>this.handleKeydown(t)),this.cards.forEach(t=>{t.addEventListener("focus",()=>this.handleCardFocus(t))})}handleScroll(){const{scrollLeft:t,clientWidth:e,scrollWidth:a}=this.track,n=this.cards[0].offsetWidth+this.getTrackGap();let r=Math.floor(Math.round(t/n)/this.cardsPerPage);t+e>=a&&(r=this.totalPages-1),r!==this.currentPage&&(this.currentPage=r,this.updateNavigation(),this.announcePageChange(),this.updateAriaAttributes())}handleKeydown(t){switch(t.key){case"ArrowLeft":t.preventDefault(),this.navigate(-1);break;case"ArrowRight":t.preventDefault(),this.navigate(1);break;case"Home":t.preventDefault(),this.goToFirstPage();break;case"End":t.preventDefault(),this.goToLastPage();break}}goToFirstPage(){this.currentPage=0,this.updateNavigation(),this.updateTrackPosition(),this.announcePageChange()}goToLastPage(){this.currentPage=this.totalPages-1,this.updateNavigation(),this.updateTrackPosition(),this.announcePageChange()}handleCardFocus(t){const e=this.cards.indexOf(t),a=Math.floor(e/this.cardsPerPage);a!==this.currentPage&&(this.currentPage=Math.min(a,this.totalPages-1),this.updateNavigation(),this.updateTrackPosition())}announcePageChange(){const t=this.getOptimalStartIndex(),e=Math.min(t+this.cardsPerPage,this.cards.length),a=`Showing cards ${t+1} to ${e} of ${this.cards.length}`;this.liveRegion.textContent=a}updateAriaAttributes(){const t=this.getOptimalStartIndex();this.cards.forEach((e,a)=>{const s=a>=t&&a<t+this.cardsPerPage;e.setAttribute("aria-hidden",(!s).toString()),e.setAttribute("tabindex",s?"0":"-1")}),this.container.setAttribute("aria-label",`Card carousel, page ${this.currentPage+1} of ${this.totalPages}`)}navigate(t){const e=this.currentPage+t;e<0||e>=this.totalPages||(this.currentPage=e,this.updateNavigation(),this.updateTrackPosition(),this.announcePageChange())}updateTrackPosition(){const t=this.getOptimalStartIndex(),e=this.cards[t];e&&this.track.scrollTo({left:e.offsetLeft,behavior:"smooth"}),this.updateAriaAttributes()}updateNavigation(){this.prevButton.disabled=this.currentPage===0,this.prevButton.classList.toggle("disabled",this.currentPage===0),this.prevButton.setAttribute("aria-disabled",(this.currentPage===0).toString());const t=this.isLastPage();this.nextButton.disabled=t,this.nextButton.classList.toggle("disabled",t),this.nextButton.setAttribute("aria-disabled",t.toString());const e=this.prevButton.disabled&&this.nextButton.disabled;this.nextButton.classList.toggle("hidden",e),this.prevButton.classList.toggle("hidden",e),this.prevButton.parentElement?.classList.toggle("hidden",e)}}document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll('[data-qa="BlockCardContainerCarousel"]').forEach(i=>{const t={container:i,track:i.querySelector('[data-qa="BlockCardContainer"]'),cards:Array.from(i.querySelectorAll('[data-qa="BlockCardContainer"] > div')),prevButton:i.querySelector(".prev"),nextButton:i.querySelector(".next")};new o(t)})});
